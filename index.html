<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tors‑Bored Studio — Interactive Gallery</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat+Brush&family=Caveat:wght@400..700&display=swap" rel="stylesheet">
  <style>
    /* Page frame */
    html { margin: 0; }
    body {
      margin: 0;
      min-height: 100vh;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 16px 0;
      background: radial-gradient(60% 80% at 50% 40%, #1d2b23 0%, #0f1512 100%);
      -webkit-overflow-scrolling: touch;
    }

    /* Responsive SVG container: keep full painting visible without crop */
    .stage-wrap {
      position: relative;
      width: 100vw;
      margin: 0 auto;
      overflow-x: auto;
      overflow-y: visible;
      scroll-behavior: smooth;
      cursor: grab;
    }
    .stage-wrap:active { cursor: grabbing; }
    .stage {
      display: block;
      width: 100vw;
      height: auto;
      aspect-ratio: 1536 / 1024;
      margin: 0 auto;

      box-shadow: 0 20px 60px rgba(0,0,0,0.35);
      border-radius: 14px;
      background: #0a0d0c;
    }
    @media (max-aspect-ratio: 3/2) {
      .stage {
        width: auto;
        height: max(120vh, 120dvh, 120svh);
      }
    }

    /* Interaction affordances */
    .vase {
      cursor: pointer;
      outline: none;
      /* Enable CSS transforms to respect the element box */
      transform-box: fill-box; /* critical for SVG */
      transform-origin: center;
      transition: transform 160ms ease, filter 160ms ease;
    }
    .vase:hover,
    .vase:focus-visible,
    .vase[aria-expanded="true"] { /* expanded when bubble open */
      transform: scale(1.02);
      filter: url(#white-outline);
    }
    .vase, .vase image { pointer-events: auto; }

    /* Thought bubbles */
    .bubble { display: none; }
    .bubble.open { display: block; }

    /* Bubble text styling */
    .bubble text { font-family: ui-serif, Georgia, "Times New Roman", serif; font-size: 18px; fill: #1b1b1b; }
    .bubble .title { font-weight: 700; }
    .bubble .body { font-size: 16px; }

    /* Foreign object bubble content styling */
    .bubble-content {
      font-family: "Caveat", cursive;
      color: #1b1b1b;
      text-align: center;
      padding: 8px 12px;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 4px;
      box-sizing: border-box;
    }
    .bubble-content .title {
      font-family: "Caveat Brush", cursive;
      font-weight: 400;
      font-size: 20px;
      line-height: 1.2;
      word-wrap: break-word;
    }
    .bubble-content .body {
      font-family: "Caveat", cursive;
      font-optical-sizing: auto;
      font-weight: 500;
      font-style: normal;
      font-size: 18px;
      line-height: 1.3;
      word-wrap: break-word;
    }
    .bubble-content a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 4px 10px;
      margin-top: 6px;
      border-radius: 999px;
      background: rgba(0,0,0,0.75);
      color: #f4f4f4;
      font-size: 15px;
      text-decoration: none;
    }
    .bubble-content a:hover,
    .bubble-content a:focus-visible {
      background: rgba(0,0,0,0.9);
    }

    /* Accessibility helper for keyboard focus */
    .visually-hidden { position: absolute; width: 1px; height: 1px; margin: -1px; border: 0; padding: 0; clip: rect(0 0 0 0); overflow: hidden; }

    /* About modal overlay */
    .overlay[hidden] { display: none !important; }
    .overlay { position: fixed; inset: 0; z-index: 999; }
    .overlay .backdrop {
      position: absolute; inset: 0;
      background: radial-gradient(ellipse at 50% 45%, rgba(0,0,0,0.40) 68%, rgba(0,0,0,0.70) 100%);
    }
    .panel {
      position: absolute; inset: 0; margin: auto;
      width: min(680px, 92vw);
      max-height: min(85vh, 760px);
      background: #f7f3e8 url('images/paper-texture.png') center/cover no-repeat;
      border-radius: 18px;
      box-shadow: 0 24px 80px rgba(0,0,0,0.35);
      padding: 24px 28px 28px;
      overflow: auto;
      opacity: 0;
      transform: translateY(6px) scale(0.985);
      transition: opacity 160ms ease, transform 160ms ease;
    }
    .overlay:not([hidden]) .panel { opacity: 1; transform: translateY(0) scale(1); }
    .panel .close {
      position: absolute;
      top: 16px;
      right: 18px;
      border: none;
      background: transparent;
      font-size: 28px;
      line-height: 1;
      color: #4b4233;
      cursor: pointer;
    }
    .panel .head { margin-bottom: 12px; }
    .panel .head h2 {
      margin: 0;
      font-family: "Caveat Brush", cursive;
      font-size: 36px;
      color: #3a2f23;
    }
    .panel .content {
      font-family: "Caveat", cursive;
      color: #403226;
      font-size: 20px;
      line-height: 1.4;
      display: grid;
      gap: 12px;
    }
    .panel .content h3 {
      margin: 8px 0 0;
      font-family: "Caveat Brush", cursive;
      font-weight: 400;
      font-size: 26px;
      color: #2d2017;
    }
    .panel .content p { margin: 0; }
    .about-carousel {
      display: grid;
      gap: 8px;
      margin: 8px auto 16px;
      width: min(340px, 100%);
    }
    .about-carousel__viewport {
      position: relative;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 12px 32px rgba(0,0,0,0.28);
    }
    .about-carousel__slide {
      margin: 0;
      min-height: 0;
    }
    .about-carousel__slide img {
      display: block;
      width: 100%;
      height: auto;
    }
    .about-carousel__controls {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
    }
    .about-carousel__button {
      border: none;
      border-radius: 999px;
      width: 38px;
      height: 38px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.9);
      box-shadow: 0 6px 18px rgba(0,0,0,0.18);
      color: #2a2119;
      font-size: 22px;
      cursor: pointer;
      transition: transform 140ms ease, box-shadow 140ms ease;
    }
    .about-carousel__button:hover,
    .about-carousel__button:focus-visible {
      transform: translateY(-2px);
      box-shadow: 0 12px 26px rgba(0,0,0,0.22);
    }
    .about-carousel__status {
      font-size: 18px;
    }
    .panel .social {
      display: flex;
      gap: 16px;
    }
    .panel .social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: rgba(255,255,255,0.85);
      box-shadow: 0 6px 18px rgba(0,0,0,0.18);
      color: #2a2119;
      text-decoration: none;
      transition: transform 140ms ease, box-shadow 140ms ease;
    }
    .panel .social a:hover,
    .panel .social a:focus-visible {
      transform: translateY(-3px);
      box-shadow: 0 10px 24px rgba(0,0,0,0.22);
    }
    .panel .social svg {
      width: 22px;
      height: 22px;
      fill: currentColor;
    }
  </style>
</head>
<body>

  <!-- Single SVG scene with shared coordinate system -->
  <div class="stage-wrap">
  <svg id="scene" class="stage" viewBox="0 0 1536 1024" role="img" aria-label="Tors-Bored Studio interactive pottery gallery">
    <defs>
      <!-- Small white outline that hugs image alpha; applied on hover/focus -->
      <filter id="white-outline" x="-20%" y="-20%" width="140%" height="140%" color-interpolation-filters="sRGB">
        <!-- Extract alpha -->
        <feColorMatrix in="SourceAlpha" type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0" result="alpha"/>
        <!-- Slightly dilate and blur to create a soft halo -->
        <feMorphology in="alpha" operator="dilate" radius="0.7" result="dilated"/>
        <feGaussianBlur in="dilated" stdDeviation="1.1" result="blur"/>
        <!-- Paint it white -->
        <feFlood flood-color="#ffffff" flood-opacity="1" result="white"/>
        <feComposite in="white" in2="blur" operator="in" result="outline"/>
        <!-- Put outline behind the original graphic -->
        <feMerge>
          <feMergeNode in="outline"/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>

      <!-- Bubble shape definitions: rounded rect + soft shadow -->
      <filter id="bubble-shadow" x="-20%" y="-30%" width="160%" height="200%">
        <feDropShadow dx="0" dy="3" stdDeviation="3" flood-color="#000" flood-opacity="0.25"/>
      </filter>
    </defs>

    <!-- Background painting -->
    <image href="images/background.jpeg" x="0" y="0" width="1536" height="1024" preserveAspectRatio="none"/>

    <!-- Title / Logo -->
    <g id="title">
      <image href="images/tors-bored.png" x="511" y="0" width="384" height="256"/>
    </g>

    <!-- About sign linking to overlay -->
    <a id="about-link" href="#about" aria-label="About Tors-Bored Studio">
      <image href="images/about.png" x="1256" y="0" width="192" height="192"/>
    </a>

    <!-- ===== VASES (each inside a focusable <g>) ===== -->

    <!-- Helper: bubble templates will be cloned/positioned via JS per vase -->
    <!-- Default bubble template (tail pointing down) -->
    <g id="bubble-template" class="bubble" opacity="0.98">
      <!-- rect background -->
      <rect x="-130" y="-130" width="260" height="140" rx="18" ry="18" fill="#faf6f0" filter="url(#bubble-shadow)"/>
      <!-- tail (triangle-ish) pointing downward by default -->
      <path d="M 0 10 L -10 0 L 10 0 Z" fill="#faf6f0"/>
      <!-- text blocks using foreignObject for text wrapping -->
      <foreignObject x="-120" y="-120" width="240" height="130">
        <div class="bubble-content" xmlns="http://www.w3.org/1999/xhtml">
          <div class="title">Title</div>
          <div class="body">Body</div>
        </div>
      </foreignObject>
    </g>


    <!-- Left bubble template (tail pointing right) -->
    <g id="bubble-template-left" class="bubble" opacity="0.98">
      <!-- rect background -->
      <rect x="-260" y="-70" width="260" height="130" rx="18" ry="18" fill="#faf6f0" filter="url(#bubble-shadow)"/>
      <!-- tail pointing right -->
      <path d="M 0 0 L -10 -10 L -10 10 Z" fill="#faf6f0"/>
      <!-- text blocks using foreignObject for text wrapping -->
      <foreignObject x="-250" y="-60" width="240" height="120">
        <div class="bubble-content" xmlns="http://www.w3.org/1999/xhtml">
          <div class="title">Title</div>
          <div class="body">Body</div>
        </div>
      </foreignObject>
    </g>

    <!-- Right bubble template (tail pointing left) -->
    <g id="bubble-template-right" class="bubble" opacity="0.98">
      <!-- rect background -->
      <rect x="0" y="-70" width="260" height="130" rx="18" ry="18" fill="#faf6f0" filter="url(#bubble-shadow)"/>
      <!-- tail pointing left -->
      <path d="M 0 0 L 10 -10 L 10 10 Z" fill="#faf6f0"/>
      <!-- text blocks using foreignObject for text wrapping -->
      <foreignObject x="10" y="-60" width="240" height="120">
        <div class="bubble-content" xmlns="http://www.w3.org/1999/xhtml">
          <div class="title">Title</div>
          <div class="body">Body</div>
        </div>
      </foreignObject>
    </g>


    <!-- Green Spiral Vase -->
    <g id="vase-green" class="vase" tabindex="0" role="button" aria-label="Green Spiral Vase" aria-expanded="false"
       data-title="Green Spiral Vase"
       data-body="Tall coil form, carved spirals, olive over ochre."
       data-bubble-offset="56">
      <image href="images/green-vase.png" x="400" y="349" width="242" height="363"/>
    </g>

    <!-- Owl (Fnoobie) -->
    <g id="vase-owl" class="vase" tabindex="0" role="button" aria-label="Owl Vase" aria-expanded="false"
       data-title="Owl Vase (Fnoobie)"
       data-body="Textured stoneware, butter glaze; cozy night light."
       data-bubble-offset="56"
       data-bubble-position="left">
      <image href="images/fnoobie.png" x="1351" y="525" width="126" height="189" transform="rotate(5 1414 613.5)"/>
    </g>

    <!-- Tomato Jar -->
    <g id="vase-tomato" class="vase" tabindex="0" role="button" aria-label="Tomato Jar" aria-expanded="false"
       data-title="Tor-Chinese"
       data-body="Simple app to learn one character a day, breaking hanzi into visual parts."
       data-bubble-offset="96"
       data-bubble-position="right"
       data-bubble-offset-x="-10"
       data-bubble-offset-y="-24"
       data-preview-url="images/previews/tor-chinese.png">
      <image href="images/tomato.png" x="777" y="555" width="157" height="157"/>
    </g>

    <!-- White Tall Ribbed -->
    <g id="vase-ribbed" class="vase" tabindex="0" role="button" aria-label="White Tall Ribbed" aria-expanded="false"
       data-title="White Tall Ribbed"
       data-body="Thrown, altered; speckled clay, satin eggshell."
       data-bubble-offset="72">
      <image href="images/white-rib-vase.png" x="664" y="765" width="139" height="209"/>
    </g>

    <!-- Multicolor (Mondrian) -->
    <g id="vase-mondrian" class="vase" tabindex="0" role="button" aria-label="Multicolor Vase"
       data-title="Multicolor Vase"
       data-body="Playful color blocks over warm porcelain."
       data-bubble-offset="72">
      <image href="images/multicolor-vase.png" x="239" y="783" width="161" height="241"/>
    </g>

    <!-- Flower Vase -->
    <g id="vase-flower" class="vase" tabindex="0" role="button" aria-label="Flower Vase" aria-expanded="false"
       data-title="Flower Vase"
       data-body="Soft blossoms over matte ivory; spring in a vessel."
       data-bubble-offset="56"
       data-bubble-position="right">
      <image href="images/white-flower.png" x="30.9" y="515" width="90" height="139" transform="rotate(-6 74.9 577.97)"/>
    </g>

  </svg>
  </div>

  <!-- ===== ABOUT MODAL (overlay) ===== -->
  <div id="about-overlay" class="overlay" hidden>
    <div class="backdrop" data-close="true" aria-hidden="true"></div>

    <section
      id="about-modal"
      class="panel"
      role="dialog"
      aria-modal="true"
      aria-labelledby="about-title"
      aria-describedby="about-desc"
    >
      <button class="close" type="button" aria-label="Close About">&times;</button>

      <header class="head">
        <h2 id="about-title">About Tor</h2>
      </header>

      <div id="about-desc" class="content">
        <p><strong>Hey, my name's Tor.</strong> I'm from Saint Paul, Minnesota, a Notre Dame graduate, now living in NYC. I have a passion for building and trying new things in and outside of work. This includes, but isn't limited to: pottery, cooking, baking, yo-yoing, various adult rec sports, and more.</p>

        <h3>About the Projects</h3>
        <p>The projects shown here are ways I use programming and coding to make life easier&mdash;or just to try new things. All the project images on the homepage are actual vases I made.</p>

        <div class="about-carousel" aria-label="Tor's photo highlights">
          <div class="about-carousel__viewport">
            <figure class="about-carousel__slide" data-index="0">
              <img src="images/carosel/Personal photo.JPEG" alt="Tor pottery photo 1">
            </figure>
            <figure class="about-carousel__slide" data-index="1" hidden>
              <img src="images/carosel/pots.jpeg" alt="Tor pottery photo 2">
            </figure>
            <figure class="about-carousel__slide" data-index="2" hidden>
              <img src="images/carosel/peru.JPG" alt="Tor pottery photo 3">
            </figure>
            <figure class="about-carousel__slide" data-index="3" hidden>
              <img src="images/carosel/india.jpeg" alt="Tor pottery photo 4">
            </figure>
            <figure class="about-carousel__slide" data-index="4" hidden>
              <img src="images/carosel/korea.JPG" alt="Tor pottery photo 5">
            </figure>
            <figure class="about-carousel__slide" data-index="4" hidden>
              <img src="images/carosel/pots2.JPG" alt="Tor pottery photo 5">
            </figure>
          </div>
          <div class="about-carousel__controls">
            <button class="about-carousel__button about-carousel__button--prev" type="button" aria-label="Previous photo">&#8592;</button>
            <span class="about-carousel__status" aria-live="polite">1 of 5</span>
            <button class="about-carousel__button about-carousel__button--next" type="button" aria-label="Next photo">&#8594;</button>
          </div>
        </div>

        <h3>Find Me Elsewhere</h3>
        <nav class="social">
          <a href="mailto:vcox484@gmail.com" aria-label="Email Tor">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 5h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2Zm0 2v.34l8 5.33 8-5.33V7H4Zm16 10V9.66l-7.55 5.02a1 1 0 0 1-1.1 0L4 9.66V17h16Z"/></svg>
          </a>
          <a href="https://www.linkedin.com/in/tor-iv/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20.45 20.45h-3.56v-5.56c0-1.33-.02-3.05-1.86-3.05-1.86 0-2.14 1.45-2.14 2.95v5.66H9.34V9.5h3.41v1.49h.05c.48-.9 1.64-1.86 3.38-1.86 3.62 0 4.29 2.38 4.29 5.47v5.85ZM5.34 8.01a2.06 2.06 0 1 1 0-4.12 2.06 2.06 0 0 1 0 4.12ZM7.12 20.45H3.56V9.5h3.56v10.95Z"/></svg>
          </a>
          <a href="https://www.instagram.com/tor_iv/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.16c3.2 0 3.58.01 4.85.07 1.17.05 1.96.24 2.64.51.64.25 1.18.59 1.71 1.12.54.53.87 1.07 1.12 1.71.27.68.46 1.47.51 2.64.06 1.27.07 1.65.07 4.85s-.01 3.58-.07 4.85c-.05 1.17-.24 1.96-.51 2.64a4.54 4.54 0 0 1-2.83 2.83c-.68.27-1.47.46-2.64.51-1.27.06-1.65.07-4.85.07s-3.58-.01-4.85-.07c-1.17-.05-1.96-.24-2.64-.51a4.54 4.54 0 0 1-2.83-2.83c-.27-.68-.46-1.47-.51-2.64C2.17 15.58 2.16 15.2 2.16 12s.01-3.58.07-4.85c.05-1.17.24-1.96.51-2.64A4.54 4.54 0 0 1 5.57 1.68c.68-.27 1.47-.46 2.64-.51C9.48 1.11 9.86 1.1 13.06 1.1Zm0 1.93c-3.15 0-3.52.01-4.76.07-.98.05-1.51.21-1.86.35-.47.18-.81.39-1.17.76-.37.36-.58.7-.76 1.17-.14.35-.3.88-.35 1.86-.06 1.24-.07 1.61-.07 4.76s.01 3.52.07 4.76c.05.98.21 1.51.35 1.86.18.47.39.81.76 1.17.36.37.7.58 1.17.76.35.14.88.3 1.86.35 1.24.06 1.61.07 4.76.07s3.52-.01 4.76-.07c.98-.05 1.51-.21 1.86-.35.47-.18.81-.39 1.17-.76.37-.36.58-.7.76-1.17.14-.35.3-.88.35-1.86.06-1.24.07-1.61.07-4.76s-.01-3.52-.07-4.76c-.05-.98-.21-1.51-.35-1.86-.18-.47-.39-.81-.76-1.17a2.74 2.74 0 0 0-1.17-.76c-.35-.14-.88-.3-1.86-.35-1.24-.06-1.61-.07-4.76-.07Zm0 3.27a4.64 4.64 0 1 1 0 9.28 4.64 4.64 0 0 1 0-9.28Zm0 7.65a2.99 2.99 0 1 0 0-5.98 2.99 2.99 0 0 0 0 5.98Zm5.91-8.84a1.08 1.08 0 1 1-2.16 0 1.08 1.08 0 0 1 2.16 0Z"/></svg>
          </a>
          <a href="https://github.com/tor-iv" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .54a11.46 11.46 0 0 0-3.62 22.35c.57.1.78-.25.78-.56v-2c-3.19.7-3.86-1.54-3.86-1.54-.52-1.34-1.26-1.7-1.26-1.7-1.03-.7.08-.69.08-.69 1.14.08 1.73 1.17 1.73 1.17 1.01 1.73 2.65 1.23 3.3.94.1-.74.4-1.23.72-1.52-2.55-.29-5.24-1.29-5.24-5.75 0-1.27.45-2.31 1.17-3.13-.12-.29-.51-1.47.11-3.07 0 0 .96-.31 3.14 1.19a10.8 10.8 0 0 1 5.72 0c2.18-1.5 3.14-1.19 3.14-1.19.62 1.6.24 2.78.12 3.07.73.82 1.17 1.86 1.17 3.13 0 4.47-2.7 5.46-5.27 5.74.41.36.78 1.07.78 2.16v3.19c0 .31.2.67.79.55A11.46 11.46 0 0 0 12 .54Z"/></svg>
          </a>
        </nav>
      </div>
    </section>
  </div>

  <script>
    (function() {
      const wrap = document.querySelector('.stage-wrap');
      if (!wrap) return;

      function hasHorizontalOverflow() {
        return wrap.scrollWidth > wrap.clientWidth + 1;
      }

      function centerScene() {
        requestAnimationFrame(() => {
          const maxScroll = wrap.scrollWidth - wrap.clientWidth;
          wrap.scrollLeft = maxScroll > 0 ? maxScroll / 2 : 0;
        });
      }

      window.addEventListener('load', centerScene);
      window.addEventListener('resize', centerScene);

      let isMouseDown = false;
      let startX = 0;
      let startScroll = 0;

      wrap.addEventListener('mousedown', (event) => {
        if (!hasHorizontalOverflow()) return;
        if (event.button !== 0) return;
        if (event.target.closest('a, button, .vase')) return;
        isMouseDown = true;
        startX = event.clientX;
        startScroll = wrap.scrollLeft;
        wrap.classList.add('dragging');
        wrap.style.cursor = 'grabbing';
      });

      window.addEventListener('mouseup', () => {
        if (!isMouseDown) return;
        isMouseDown = false;
        wrap.classList.remove('dragging');
        wrap.style.cursor = '';
      });

      window.addEventListener('mousemove', (event) => {
        if (!isMouseDown) return;
        wrap.scrollLeft = startScroll - (event.clientX - startX);
      });

      let touchStartX = 0;
      let touchStartY = 0;
      let draggingHorizontally = false;

      wrap.addEventListener('touchstart', (event) => {
        const touch = event.touches[0];
        touchStartX = touch.clientX;
        touchStartY = touch.clientY;
        draggingHorizontally = false;
      }, { passive: true });

      wrap.addEventListener('touchmove', (event) => {
        if (!hasHorizontalOverflow()) return;
        if (event.target.closest('a, button, .vase')) return;
        const touch = event.touches[0];
        const dx = touch.clientX - touchStartX;
        const dy = touch.clientY - touchStartY;

        if (!draggingHorizontally) {
          if (Math.abs(dx) > Math.abs(dy) + 4) draggingHorizontally = true;
          else return; // allow vertical scroll
        }

        event.preventDefault();
        wrap.scrollLeft -= dx;
        touchStartX = touch.clientX;
      }, { passive: false });

      centerScene();
      window.scrollTo({ top: 0, behavior: 'auto' });
    })();
  </script>

  <script>
    (function() {
      const svg = document.getElementById('scene');
      const title = document.getElementById('title');
      if (!svg || !title) return;

      const titleImage = title.querySelector('image');
      if (!titleImage) return;

      function fitTitle() {
        const sceneRect = svg.getBoundingClientRect();
        if (!sceneRect.width) return;

        const safeWidth = sceneRect.width * 0.7;
        const width = parseFloat(titleImage.getAttribute('width') || '0');
        const height = parseFloat(titleImage.getAttribute('height') || '0');
        const x = parseFloat(titleImage.getAttribute('x') || '0');
        const y = parseFloat(titleImage.getAttribute('y') || '0');

        if (!width || !height) return;

        const renderedPerUnit = sceneRect.width / 1536;
        const renderedTitleWidth = width * renderedPerUnit;
        let scale = 1;
        if (renderedTitleWidth > safeWidth) {
          scale = safeWidth / renderedTitleWidth;
        }

        const cx = x + width / 2;
        const cy = y + height / 2;
        title.setAttribute('transform', `translate(${cx} ${cy}) scale(${scale}) translate(${-cx} ${-cy})`);
      }

      const resizeObserver = new ResizeObserver(fitTitle);
      resizeObserver.observe(document.documentElement);
      window.addEventListener('load', fitTitle);
      window.addEventListener('resize', fitTitle);
      fitTitle();
    })();
  </script>

  <script>
(function() {
  const svg = document.getElementById('scene');
  const groups = Array.from(svg.querySelectorAll('.vase'));
  const template = svg.getElementById('bubble-template');
  const templateLeft = svg.getElementById('bubble-template-left');
  const templateRight = svg.getElementById('bubble-template-right');

  const canHover = window.matchMedia('(hover: hover) and (pointer: fine)').matches;
  const isTouchDevice = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);

  let openBubble = null; // { group, bubble }

  function placeBubbleForGroup(g) {
    const old = g.querySelector('.bubble.open');
    if (old && old !== template && old !== templateLeft && old !== templateRight) old.remove();

    const position = g.dataset.bubblePosition || 'top';
    const tpl = position === 'left' ? templateLeft : position === 'right' ? templateRight : template;

    const b = tpl.cloneNode(true);
    b.id = '';
    b.classList.add('open');

    const title = g.dataset.title || '';
    const body = g.dataset.body || '';
    b.querySelector('.title').textContent = title;
    b.querySelector('.body').textContent = body;

    const rect = b.querySelector('rect');
    const tail = b.querySelector('path');
    const foreignObject = b.querySelector('foreignObject');
    const contentNode = b.querySelector('.bubble-content');
    const previewUrl = g.dataset.previewUrl;
    const linkUrl = g.dataset.link;

    if (previewUrl && rect && tail && foreignObject && contentNode) {
      rect.setAttribute('x', '20');
      rect.setAttribute('y', '-210');
      rect.setAttribute('width', '300');
      rect.setAttribute('height', '240');
      tail.setAttribute('d', 'M 0 0 L 24 -22 L 24 22 Z');
      foreignObject.setAttribute('x', '36');
      foreignObject.setAttribute('y', '-198');
      foreignObject.setAttribute('width', '268');
      foreignObject.setAttribute('height', '220');

      const image = document.createElement('img');
      image.src = previewUrl;
      image.alt = `${title || 'Project'} preview`;
      image.loading = 'lazy';
      image.style.width = '100%';
      image.style.height = 'auto';
      image.style.borderRadius = '14px';
      image.style.marginTop = '6px';
      contentNode.appendChild(image);
    }

    if (linkUrl && contentNode) {
      const link = document.createElement('a');
      link.href = linkUrl;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.textContent = previewUrl ? 'View code →' : 'View project →';
      contentNode.appendChild(link);
    }

    const bbox = g.getBBox();
    const offset = parseFloat(g.dataset.bubbleOffset || '56');
    const offsetX = parseFloat(g.dataset.bubbleOffsetX || '0');
    const offsetY = parseFloat(g.dataset.bubbleOffsetY || '0');

    let ax; let ay;
    if (position === 'left') {
      ax = bbox.x - 20 + offsetX;
      ay = bbox.y + bbox.height / 2 + offsetY;
    } else if (position === 'right') {
      ax = bbox.x + bbox.width + 20 + offsetX;
      ay = bbox.y + bbox.height / 2 + offsetY;
    } else {
      ax = bbox.x + bbox.width / 2 + offsetX;
      ay = bbox.y - offset + offsetY;
    }

    b.setAttribute('transform', `translate(${ax}, ${ay})`);

    g.appendChild(b);
    g.setAttribute('aria-expanded', 'true');
    openBubble = { group: g, bubble: b };
  }

  function closeOpenBubble() {
    if (!openBubble) return;
    const { group, bubble } = openBubble;
    if (bubble && bubble.parentNode) bubble.parentNode.removeChild(bubble);
    if (group) group.setAttribute('aria-expanded', 'false');
    openBubble = null;
  }

  groups.forEach(g => {
    g.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        if (openBubble && openBubble.group === g) closeOpenBubble();
        else { closeOpenBubble(); placeBubbleForGroup(g); }
      }
      if (e.key === 'Escape') closeOpenBubble();
    });

    if (canHover) {
      g.addEventListener('pointerenter', () => {
        closeOpenBubble();
        placeBubbleForGroup(g);
      });
      g.addEventListener('pointerleave', () => {
        if (openBubble && openBubble.group === g) closeOpenBubble();
      });
    } else {
      g.addEventListener('click', (e) => {
        e.stopPropagation();
        if (openBubble && openBubble.group === g) closeOpenBubble();
        else { closeOpenBubble(); placeBubbleForGroup(g); }
      });
    }
  });

  document.addEventListener('click', (e) => {
    if (!openBubble) return;
    if (!svg.contains(e.target)) closeOpenBubble();
  }, { passive: true });

  if (isTouchDevice) {
    document.addEventListener('touchstart', (e) => {
      if (!openBubble) return;
      if (!svg.contains(e.target)) closeOpenBubble();
    }, { passive: true });
  }

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeOpenBubble();
  });
})();
</script>


  <script>
    (function() {
      const aboutLink = document.getElementById('about-link');
      const overlay = document.getElementById('about-overlay');
      if (!aboutLink || !overlay) return;

      const closeBtn = overlay.querySelector('.close');
      const backdrop = overlay.querySelector('.backdrop');
      const carousel = overlay.querySelector('.about-carousel');
      let lastFocus = null;
      let carouselIndex = 0;

      const carouselSlides = carousel ? Array.from(carousel.querySelectorAll('.about-carousel__slide')) : [];
      const carouselStatus = carousel ? carousel.querySelector('.about-carousel__status') : null;
      const carouselPrev = carousel ? carousel.querySelector('.about-carousel__button--prev') : null;
      const carouselNext = carousel ? carousel.querySelector('.about-carousel__button--next') : null;

      function updateCarousel(newIndex) {
        if (!carouselSlides.length) return;
        carouselIndex = (newIndex + carouselSlides.length) % carouselSlides.length;
        carouselSlides.forEach((slide, idx) => {
          if (idx === carouselIndex) slide.removeAttribute('hidden');
          else slide.setAttribute('hidden', '');
        });
        if (carouselStatus) carouselStatus.textContent = `${carouselIndex + 1} of ${carouselSlides.length}`;
      }

      function openAbout() {
        lastFocus = document.activeElement;
        overlay.hidden = false;
        if (closeBtn) closeBtn.focus();
        updateCarousel(0);
      }

      function closeAbout() {
        overlay.hidden = true;
        if (lastFocus && typeof lastFocus.focus === 'function') lastFocus.focus();
      }

      aboutLink.addEventListener('click', (event) => {
        event.preventDefault();
        openAbout();
      });

      if (closeBtn) closeBtn.addEventListener('click', closeAbout);
      if (backdrop) backdrop.addEventListener('click', closeAbout);

      if (carouselPrev && carouselNext) {
        if (carouselSlides.length <= 1) {
          carouselPrev.disabled = true;
          carouselNext.disabled = true;
        }
        carouselPrev.addEventListener('click', () => updateCarousel(carouselIndex - 1));
        carouselNext.addEventListener('click', () => updateCarousel(carouselIndex + 1));
      }

      document.addEventListener('keydown', (event) => {
        if (!overlay.hidden && event.key === 'Escape') closeAbout();
      });

      overlay.addEventListener('keydown', (event) => {
        if (event.key !== 'Tab') return;
        const focusable = overlay.querySelectorAll('button, [href], [tabindex]:not([tabindex="-1"])');
        const list = Array.from(focusable);
        if (!list.length) return;
        const first = list[0];
        const last = list[list.length - 1];
        if (event.shiftKey && document.activeElement === first) {
          event.preventDefault();
          last.focus();
        } else if (!event.shiftKey && document.activeElement === last) {
          event.preventDefault();
          first.focus();
        }
      });
    })();
  </script>
</body>
</html>
